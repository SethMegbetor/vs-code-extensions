!function(t,e){for(var n in e)t[n]=e[n]}(exports,function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=438)}({0:function(t,e){t.exports=require("path")},1:function(t,e){t.exports=require("fs")},13:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.rmdirLocal=e.mkdirpLocal=e.unlinkLocal=e.readLocalDir=e.renameLocal=e.writeLocalFile=e.readLocalFile=e.isLocalFile=void 0;const r=n(1),o=n(6),i=n(77);e.isLocalFile=function(t){return new Promise(e=>r.stat(t,(t,n)=>e(!t&&n.isFile())))},e.readLocalFile=o.promisify(r.readFile),e.writeLocalFile=o.promisify(r.writeFile),e.renameLocal=o.promisify(r.rename),e.readLocalDir=o.promisify(r.readdir),e.unlinkLocal=o.promisify(r.unlink),e.mkdirpLocal=i,e.rmdirLocal=o.promisify(r.rmdir)},15:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toTagNamePart=e.toExecParameters=e.dockerPtyExecFunction=e.dockerExecFunction=e.dockerComposePtyCLI=e.dockerComposeCLI=e.dockerPtyCLI=e.isPodman=e.dockerCLI=e.getEvents=e.createVolume=e.listDanglingVolumes=e.listVolumes=e.listContainers=e.inspectVolumes=e.inspectVolume=e.inspectImage=e.inspectContainers=e.inspectContainer=void 0;const r=n(3),o=n(4);async function i(t,e){const n=await s(t,"container",e);for(const t of n){t.Ports=[];const e=t.NetworkSettings.Ports;for(const n in e){const[r,o]=n.split("/");for(const i of e[n]||[]){const{HostIp:e,HostPort:n}=i;t.Ports.push({IP:e,PrivatePort:parseInt(r),PublicPort:parseInt(n),Type:o})}}}return n}async function s(t,e,n){if(!n.length)return[];const o=await r.runCommandNoPty({...d(t),args:["inspect","--type",e,...n]});try{return JSON.parse(o.stdout.toString())}catch(t){throw console.error({stdout:o.stdout.toString(),stderr:o.stderr.toString()}),t}}async function c(t,...e){return r.runCommandNoPty({...d(t),args:e})}async function a(t){if("linux"!==("cliHost"in t?t.cliHost:t.common.cliHost).platform)return!1;try{const{stdout:e}=await c(t,"-v");return-1!==e.toString().toLowerCase().indexOf("podman")}catch(t){return!1}}function u(t,e,n){const{env:r,cwd:o,cmd:i,args:s}=n,c=["exec","-i"];return e&&c.push("-u",e),r&&Object.keys(r).forEach(t=>c.push("-e",`${t}=${r[t]}`)),o&&c.push("-w",o),c.push(t,i),s&&c.push(...s),c}function d(t){return"dockerEnv"in t?{exec:t.common.cliHost.exec,cmd:t.dockerCLI,env:t.dockerEnv,output:t.common.output}:"cliHost"in t?{exec:t.cliHost.exec,cmd:t.dockerCLI,env:t.env,output:t.output}:t}function l(t){return"dockerEnv"in t?{ptyExec:t.common.cliHost.ptyExec,cmd:t.dockerCLI,env:t.dockerEnv,output:t.common.output}:"cliHost"in t?{ptyExec:t.cliHost.ptyExec,cmd:t.dockerCLI,env:t.env,output:t.output}:t}e.inspectContainer=async function(t,e){return(await i(t,[e]))[0]},e.inspectContainers=i,e.inspectImage=async function(t,e){return(await s(t,"image",[e]))[0]},e.inspectVolume=async function(t,e){return(await s(t,"volume",[e]))[0]},e.inspectVolumes=async function(t,e){return s(t,"volume",e)},e.listContainers=async function(t,e=!1,n=[]){const r=[];e&&r.push("-a");for(const t of n)r.push("--filter","label="+t);return(await c(t,"ps","-q",...r)).stdout.toString().split(/\r?\n/).filter(t=>!!t)},e.listVolumes=async function(t,e=[]){const n=[];for(const t of e)n.push("--filter","label="+t);return(await c(t,"volume","ls","-q",...n)).stdout.toString().split(/\r?\n/).filter(t=>!!t)},e.listDanglingVolumes=async function(t){return(await c(t,"volume","ls","-q","-f","dangling=true")).stdout.toString().split(/\r?\n/).filter(t=>!!t)},e.createVolume=async function(t,e,n){const r=[];for(const t of n)r.push("--label",t);await c(t,"volume","create",...r,e)},e.getEvents=async function(t,e){const{exec:n,cmd:r,env:i,output:s}=d(t),c=[];for(const t in e)for(const n of e[t])c.push("--filter",`${t}=${n}`);const u=["events","--format",await a(t)?"json":"{{json .}}",...c],l=await n({cmd:r,args:u,env:i,output:s}),p=[];return l.stderr.on("data",t=>p.push(t)),l.exit.catch(t=>{s.write(o.toErrorText(t&&(t.stack||t.message)))}),l.exit.then(({code:t,signal:e})=>{p.length&&s.write(o.toErrorText(Buffer.concat(p).toString())),(t||e&&"SIGKILL"!==e)&&s.write(o.toErrorText(`Docker events terminated (code: ${t}, signal: ${e}).`))}),l},e.dockerCLI=c,e.isPodman=a,e.dockerPtyCLI=async function(t,...e){return r.runCommand({...l(t),args:e})},e.dockerComposeCLI=async function(t,...e){return r.runCommandNoPty({...d(t),cmd:"docker-compose",args:e})},e.dockerComposePtyCLI=async function(t,...e){return r.runCommand({...l(t),cmd:"docker-compose",args:e})},e.dockerExecFunction=function(t,e,n){const{exec:r,cmd:o,env:i}=d(t);return async function(t){const s=u(e,n,t);return r({cmd:o,args:s,env:i,output:t.output})}},e.dockerPtyExecFunction=async function(t,e,n,r){if(!await r("node-pty"))throw new Error("Missing node-pty");const{ptyExec:o,cmd:i,env:s}=l(t);return async function(t){const r=u(e,n,t);return o({cmd:i,args:r,env:s,output:t.output})}},e.toExecParameters=d,e.toTagNamePart=function(t){return t.replace(/[^a-zA-Z0-9_.-]/g,"").toLowerCase()}},155:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Queue=e.sendData=e.readJSON=e.Server=e.createServer=void 0;const r=n(0),o=n(9),i=n(8),s=n(24);e.createServer=async function(t,e){const n=function(t){if("win32"===process.platform)return`\\\\.\\pipe\\${t}-sock`;if(process.env.XDG_RUNTIME_DIR)return r.join(process.env.XDG_RUNTIME_DIR,t+".sock");return r.join(i.tmpdir(),t+".sock")}(`${t}-${(await async function(t){return new Promise((e,n)=>{s.randomBytes(t,(t,r)=>{t?n(t):e(r)})})}(20)).toString("hex")}`),o=new c(n,e);return o.listen(),o};class c{constructor(t,e){this.ipcHandlePath=t,this.server=o.createServer((t,n)=>{Promise.resolve(e(t,n)).catch(t=>console.error(t&&t.message||t))}),this.server.on("error",t=>console.error(t))}listen(){this.server.listen(this.ipcHandlePath)}dispose(){this.server.close()}}e.Server=c,e.readJSON=async function(t){return new Promise((e,n)=>{const r=[];t.setEncoding("utf8"),t.on("data",t=>r.push(t)),t.on("error",t=>n(t)),t.on("end",()=>{const t=JSON.parse(r.join(""));e(t)})})},e.sendData=async function(t,e){return new Promise((n,r)=>{const i={socketPath:t,path:"/",method:"POST"},s=o.request(i,t=>n(t));s.on("error",t=>r(t)),s.write(e),s.end()})};e.Queue=class{constructor(){this.messages=[]}push(t){this.messages.push(t),this.dequeueRequest&&(this.dequeueRequest.resolve(this.messages),this.dequeueRequest=void 0,this.messages=[])}async dequeue(t){if(this.messages.length){const t=this.messages;return this.messages=[],t}return this.dequeueRequest&&this.dequeueRequest.resolve([]),new Promise((e,n)=>{this.dequeueRequest={resolve:e,reject:n},"number"==typeof t&&setTimeout(n,t)})}}},17:function(t,e,n){"use strict";n.r(e),n.d(e,"URI",(function(){return f})),n.d(e,"uriToFsPath",(function(){return v}));var r,o,i,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});if("object"==typeof process)i="win32"===process.platform;else if("object"==typeof navigator){var c=navigator.userAgent;i=c.indexOf("Windows")>=0}var a=/^\w[\w\d+.-]*$/,u=/^\//,d=/^\/\//;var l="/",p=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,f=function(){function t(t,e,n,r,o,i){void 0===i&&(i=!1),"object"==typeof t?(this.scheme=t.scheme||"",this.authority=t.authority||"",this.path=t.path||"",this.query=t.query||"",this.fragment=t.fragment||""):(this.scheme=function(t,e){return t||e?t:"file"}(t,i),this.authority=e||"",this.path=function(t,e){switch(t){case"https":case"http":case"file":e?e[0]!==l&&(e=l+e):e=l}return e}(this.scheme,n||""),this.query=r||"",this.fragment=o||"",function(t,e){if(!t.scheme&&e)throw new Error('[UriError]: Scheme is missing: {scheme: "", authority: "'+t.authority+'", path: "'+t.path+'", query: "'+t.query+'", fragment: "'+t.fragment+'"}');if(t.scheme&&!a.test(t.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(t.path)if(t.authority){if(!u.test(t.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(d.test(t.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}(this,i))}return t.isUri=function(e){return e instanceof t||!!e&&("string"==typeof e.authority&&"string"==typeof e.fragment&&"string"==typeof e.path&&"string"==typeof e.query&&"string"==typeof e.scheme&&"function"==typeof e.fsPath&&"function"==typeof e.with&&"function"==typeof e.toString)},Object.defineProperty(t.prototype,"fsPath",{get:function(){return v(this,!1)},enumerable:!0,configurable:!0}),t.prototype.with=function(t){if(!t)return this;var e=t.scheme,n=t.authority,r=t.path,o=t.query,i=t.fragment;return void 0===e?e=this.scheme:null===e&&(e=""),void 0===n?n=this.authority:null===n&&(n=""),void 0===r?r=this.path:null===r&&(r=""),void 0===o?o=this.query:null===o&&(o=""),void 0===i?i=this.fragment:null===i&&(i=""),e===this.scheme&&n===this.authority&&r===this.path&&o===this.query&&i===this.fragment?this:new h(e,n,r,o,i)},t.parse=function(t,e){void 0===e&&(e=!1);var n=p.exec(t);return n?new h(n[2]||"",E(n[4]||""),E(n[5]||""),E(n[7]||""),E(n[9]||""),e):new h("","","","","")},t.file=function(t){var e="";if(i&&(t=t.replace(/\\/g,l)),t[0]===l&&t[1]===l){var n=t.indexOf(l,2);-1===n?(e=t.substring(2),t=l):(e=t.substring(2,n),t=t.substring(n)||l)}return new h("file",e,t,"","")},t.from=function(t){return new h(t.scheme,t.authority,t.path,t.query,t.fragment)},t.prototype.toString=function(t){return void 0===t&&(t=!1),S(this,t)},t.prototype.toJSON=function(){return this},t.revive=function(e){if(e){if(e instanceof t)return e;var n=new h(e);return n._formatted=e.external,n._fsPath=e._sep===m?e.fsPath:null,n}return e},t}(),m=i?1:void 0,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._formatted=null,e._fsPath=null,e}return s(e,t),Object.defineProperty(e.prototype,"fsPath",{get:function(){return this._fsPath||(this._fsPath=v(this,!1)),this._fsPath},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){return void 0===t&&(t=!1),t?S(this,!0):(this._formatted||(this._formatted=S(this,!1)),this._formatted)},e.prototype.toJSON=function(){var t={$mid:1};return this._fsPath&&(t.fsPath=this._fsPath,t._sep=m),this._formatted&&(t.external=this._formatted),this.path&&(t.path=this.path),this.scheme&&(t.scheme=this.scheme),this.authority&&(t.authority=this.authority),this.query&&(t.query=this.query),this.fragment&&(t.fragment=this.fragment),t},e}(f),g=((o={})[58]="%3A",o[47]="%2F",o[63]="%3F",o[35]="%23",o[91]="%5B",o[93]="%5D",o[64]="%40",o[33]="%21",o[36]="%24",o[38]="%26",o[39]="%27",o[40]="%28",o[41]="%29",o[42]="%2A",o[43]="%2B",o[44]="%2C",o[59]="%3B",o[61]="%3D",o[32]="%20",o);function y(t,e){for(var n=void 0,r=-1,o=0;o<t.length;o++){var i=t.charCodeAt(o);if(i>=97&&i<=122||i>=65&&i<=90||i>=48&&i<=57||45===i||46===i||95===i||126===i||e&&47===i)-1!==r&&(n+=encodeURIComponent(t.substring(r,o)),r=-1),void 0!==n&&(n+=t.charAt(o));else{void 0===n&&(n=t.substr(0,o));var s=g[i];void 0!==s?(-1!==r&&(n+=encodeURIComponent(t.substring(r,o)),r=-1),n+=s):-1===r&&(r=o)}}return-1!==r&&(n+=encodeURIComponent(t.substring(r))),void 0!==n?n:t}function w(t){for(var e=void 0,n=0;n<t.length;n++){var r=t.charCodeAt(n);35===r||63===r?(void 0===e&&(e=t.substr(0,n)),e+=g[r]):void 0!==e&&(e+=t[n])}return void 0!==e?e:t}function v(t,e){var n;return n=t.authority&&t.path.length>1&&"file"===t.scheme?"//"+t.authority+t.path:47===t.path.charCodeAt(0)&&(t.path.charCodeAt(1)>=65&&t.path.charCodeAt(1)<=90||t.path.charCodeAt(1)>=97&&t.path.charCodeAt(1)<=122)&&58===t.path.charCodeAt(2)?e?t.path.substr(1):t.path[1].toLowerCase()+t.path.substr(2):t.path,i&&(n=n.replace(/\//g,"\\")),n}function S(t,e){var n=e?w:y,r="",o=t.scheme,i=t.authority,s=t.path,c=t.query,a=t.fragment;if(o&&(r+=o,r+=":"),(i||"file"===o)&&(r+=l,r+=l),i){var u=i.indexOf("@");if(-1!==u){var d=i.substr(0,u);i=i.substr(u+1),-1===(u=d.indexOf(":"))?r+=n(d,!1):(r+=n(d.substr(0,u),!1),r+=":",r+=n(d.substr(u+1),!1)),r+="@"}-1===(u=(i=i.toLowerCase()).indexOf(":"))?r+=n(i,!1):(r+=n(i.substr(0,u),!1),r+=i.substr(u))}if(s){if(s.length>=3&&47===s.charCodeAt(0)&&58===s.charCodeAt(2))(p=s.charCodeAt(1))>=65&&p<=90&&(s="/"+String.fromCharCode(p+32)+":"+s.substr(3));else if(s.length>=2&&58===s.charCodeAt(1)){var p;(p=s.charCodeAt(0))>=65&&p<=90&&(s=String.fromCharCode(p+32)+":"+s.substr(2))}r+=n(s,!0)}return c&&(r+="?",r+=n(c,!1)),a&&(r+="#",r+=e?a:y(a,!1)),r}var x=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function E(t){return t.match(x)?t.replace(x,(function(t){return function t(e){try{return decodeURIComponent(e)}catch(n){return e.length>3?e.substr(0,3)+t(e.substr(3)):e}}(t)})):t}},24:function(t,e){t.exports=require("crypto")},3:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isEarlierVersion=e.parseVersion=e.toWslRemoteURI=e.toWslPath=e.getWslPath=e.parsePrintenvOutput=e.getWslDistroNameFromPath=e.isWslPath=e.createLinuxCLIHost=e.getCLIHost=e.getExecFunction=e.ptyExecFunction=e.execFunction=e.plainPtyExec=e.plainExec=e.runCommand=e.runCommandNoPty=e.isTsnode=e.tsnode=e.findProcesses=e.isEqualOrParent=e.equalPaths=e.nullLog=e.LogLevel=void 0;const r=n(0),o=n(8),i=n(1),s=n(34),c=n(4),a=n(13),u=n(17);function d(t,e,n){return"linux"===t?e===n:e.toLowerCase()===n.toLowerCase()}async function l(t){const{exec:e,cmd:n,args:r,cwd:o,env:s,stdin:a,output:u,print:d,printOnError:l}=t,p=await e({cmd:n,args:r,cwd:o,env:s,output:u});return new Promise((t,e)=>{const o=[],s=[];p.stdout.on("data",t=>{o.push(t)}),p.stderr.on("data",t=>{s.push(t)}),p.exit.catch(e),p.exit.then(({code:i})=>{try{const a=Buffer.concat(o),p=Buffer.concat(s);(d||i&&l)&&(u.write(a.toString().replace(/\r?\n/g,"\r\n")),u.write(c.toErrorText(p.toString())),i&&u.write("Exit code "+i)),i?e({message:`Command failed: ${n} ${(r||[]).join(" ")}`,stdout:a,stderr:p,code:i}):t({stdout:a,stderr:p})}catch(t){e(t)}}),a instanceof Buffer?p.stdin.write(a,t=>{t?e(t):p.stdin.end()}):a instanceof i.ReadStream&&a.pipe(p.stdin)})}function p(t){return async function(e){const{cmd:n,args:r,output:o}=e,i=`Run: ${n} ${(r||[]).join(" ").replace(/\n.*/g,"")}`,c=o.start(i),a=e.cwd||t,u=e.env?{...process.env,...e.env}:process.env,d=await g(n,a,u),l=s.spawn(d,r,{cwd:a,env:u});return{stdin:l.stdin,stdout:l.stdout,stderr:l.stderr,exit:new Promise((t,e)=>{l.once("error",t=>{o.stop(i,c),e(t)}),l.once("close",(e,n)=>{o.stop(i,c),t({code:e,signal:n})})}),async terminate(){l.kill("SIGKILL")}}}}async function f(t,e){const n=await e("node-pty");if(!n)throw new Error("Missing node-pty");return async function(e){const{cmd:r,args:o,cols:i,rows:s,output:c}=e,a=`Run: ${r} ${(o||[]).join(" ").replace(/\n.*/g,"")}`,u=c.start(a),d=e.cwd||t,l=e.env?{...process.env,...e.env}:process.env,p=await g(r,d,l),f=n.spawn(p,o||[],{cwd:d,env:l,cols:i,rows:s,useConpty:!1});return{onData:f.onData.bind(f),resize:f.resize.bind(f),exit:new Promise(t=>{f.onExit(({exitCode:e,signal:n})=>{c.stop(a,u),t({code:e,signal:n})})}),async terminate(){f.kill("SIGKILL")}}}}function m(t,e,n){return async function(r){const{env:o,cmd:i,args:c,output:a}=r,u=r.cwd||n,d=u?`cd '${u}' && `:"",l=Object.keys(o||{}).map(t=>`${t}='${o[t]}' `).join(""),p=(c||[]).map(t=>` '${t.replace(/'/g,"'\"'\"'")}'`).join(""),f=[...e,"/bin/sh","-c",`${d}${l}${i}${p}`],m=`Run: ${t} ${f.join(" ").replace(/\n.*/g,"")}`,h=a.start(m),y=await g(t,process.cwd(),process.env),w=s.spawn(y,f);return{stdin:w.stdin,stdout:w.stdout,stderr:w.stderr,exit:new Promise((t,e)=>{w.once("error",t=>{a.stop(m,h),e(t)}),w.once("close",(e,n)=>{a.stop(m,h),t({code:e,signal:n})})}),async terminate(){w.kill("SIGKILL")}}}}async function h(t,e,n,r){const o=await r("node-pty");if(!o)throw new Error("Missing node-pty");return async function(r){const{env:i,cmd:s,args:c,cols:a,rows:u,output:d}=r,l=r.cwd||n,p=l?`cd '${l}' && `:"",f=Object.keys(i||{}).map(t=>`${t}='${i[t]}' `).join(""),m=(c||[]).map(t=>` '${t.replace(/'/g,"'\"'\"'")}'`).join(""),h=[...e,"/bin/sh","-c",`${p}${f}${s}${m}`],y=`Run: ${t} ${h.join(" ").replace(/\n.*/g,"")}`,w=d.start(y),v=await g(t,process.cwd(),process.env),S=o.spawn(v,h,{cols:a,rows:u,useConpty:!1});return{onData:S.onData.bind(S),resize:S.resize.bind(S),exit:new Promise(t=>{S.onExit(({exitCode:e,signal:n})=>{d.stop(y,w),t({code:e,signal:n})})}),async terminate(){S.kill("SIGKILL")}}}}async function g(t,e=process.cwd(),n){if("win32"!==process.platform)return t;if(r.isAbsolute(t))return t;if("."!==r.dirname(t))return r.join(e,t);let o=void 0;if(n)for(let t of Object.keys(n))if("path"===t.toLowerCase()){const e=n[t];"string"==typeof e&&(o=e.split(r.delimiter));break}if(void 0===o||0===o.length)return r.join(e,t);const i=r.extname(t);for(let n of o){let o;if(o=r.isAbsolute(n)?r.join(n,t):r.join(e,n,t),i&&await a.isLocalFile(o))return o;let s=o+".com";if(await a.isLocalFile(s))return s;if(s=o+".exe",await a.isLocalFile(s))return s}return r.join(e,t)}function y(t,e,n,o,i){return{type:t,platform:"linux",exec:n,ptyExec:o,cwd:e,env:{},path:r.posix,async homedir(){return this.env.HOME},async tmpdir(){return this.env.TMPDIR||"/tmp"},isFile:async t=>{try{return await l({exec:n,cmd:"test",args:["-f",t],output:i}),!0}catch(t){return console.log(t),!1}},readFile:async t=>{try{return(await l({exec:n,cmd:"cat",args:[t],output:i})).stdout}catch(e){console.log(e);const n=new Error("Could not read file: "+t);throw n.originalError=e,n.code="ENOENT",n}},writeFile:async(t,e)=>{await l({exec:n,cmd:"/bin/sh",args:["-c",`cat >'${t}'`],stdin:e,output:i})},rename:async(t,e)=>{await l({exec:n,cmd:"mv",args:[t,e],output:i})},mkdirp:async t=>{await l({exec:n,cmd:"mkdir",args:["-p",t],output:i})},readDir:async t=>(await l({exec:n,cmd:"ls",args:["-a",t],output:i})).stdout.toString().split("\n"),getuid:async()=>{const t=await l({exec:n,cmd:"id",args:["-u"],output:i});return parseInt(t.stdout.toString().trim(),10)},getgid:async()=>{const t=await l({exec:n,cmd:"id",args:["-g"],output:i});return parseInt(t.stdout.toString().trim(),10)},toCommonURI:()=>Promise.resolve(void 0)}}!function(t){t[t.Trace=1]="Trace",t[t.Debug=2]="Debug",t[t.Info=3]="Info",t[t.Warning=4]="Warning",t[t.Error=5]="Error",t[t.Critical=6]="Critical",t[t.Off=7]="Off"}(e.LogLevel||(e.LogLevel={})),e.nullLog={write:()=>{},raw:()=>{},start:()=>Date.now(),stop:()=>{},setLogLevel:()=>{},logFilePath:""},e.equalPaths=d,e.isEqualOrParent=function({platform:t,path:e},n,r){return n===r||!(!n||!r)&&(!(r.length>n.length)&&(!(n.length>r.length&&n.charAt(r.length)!==e.sep)&&d(t,r,n.substr(0,r.length))))},e.findProcesses=async function(t){const{stdout:e}=await t.exec("for pid in `cd /proc && ls -d [0-9]*`; do { echo $pid ; readlink -f /proc/$pid/cwd ; xargs -0 < /proc/$pid/environ ; xargs -0 < /proc/$pid/cmdline ; } ; echo ; done 2>/dev/null",{logOutput:!1});return e.split("\n\n").map(t=>t.split("\n")).filter(t=>t.length>=4).map(t=>({pid:t[0],cwd:t[1],cmd:t[3],env:t[2].split(" ").reduce((t,e)=>{const n=e.indexOf("=");return-1!==n&&(t[e.substr(0,n)]=e.substr(n+1)),t},{})}))},e.tsnode=r.join(__dirname,"..","..","node_modules",".bin","ts-node"),e.isTsnode="ts-node"===r.basename(process.argv[0])||-1!==process.argv.indexOf("ts-node/register"),e.runCommandNoPty=l,e.runCommand=async function(t){var e,n;const{ptyExec:r,cmd:o,args:i,cwd:s,env:c,output:a,resolveOn:u}=t,d=await r({cmd:o,args:i,cwd:s,env:c,cols:null===(e=a.dimensions)||void 0===e?void 0:e.columns,rows:null===(n=a.dimensions)||void 0===n?void 0:n.rows,output:a});return new Promise((t,e)=>{let n="";const r=a.onDidChangeDimensions&&a.onDidChangeDimensions(t=>{d.resize(t.columns,t.rows)});d.onData(e=>{n+=e,a.raw(e),u&&u.exec(n)&&t({cmdOutput:n})}),d.exit.catch(e),d.exit.then(({code:s})=>{try{r&&r.dispose(),s?e({message:`Command failed: ${o} ${(i||[]).join(" ")}`,cmdOutput:n,code:s}):t({cmdOutput:n})}catch(t){e(t)}})})},e.plainExec=p,e.plainPtyExec=f,e.execFunction=m,e.ptyExecFunction=h,e.getExecFunction=async function(t,e){if(v(t)){const n=S(t);return m("wsl",["-d",n,"-e"],await E(n,t,e))}return p(t)},e.getCLIHost=async function(t,e,n){if("string"!=typeof t||v(t)){const r="string"==typeof t?S(t):t.wslDistro,o="string"==typeof t?await E(r,t,n):t.wslPath,i=m("wsl",["-d",r,"-e"],o),s=await h("wsl",["-d",r,"-e"],o,e),c=y("wsl",o,i,s,n);return c.env=await async function(t,e,n){let r;try{const{stdout:t}=await l({exec:p(void 0),cmd:"wsl",args:["-d",e],stdin:Buffer.from("printenv ; exit\n"),output:n,printOnError:!0});r=t.toString()}catch(e){const{stdout:o}=await l({exec:t.exec,cmd:"printenv",output:n,printOnError:!0});r=o.toString()}const o=x(r);return delete o.WSL_INTEROP,o}(c,r,n),c.toCommonURI=async t=>{try{return u.URI.file((await l({exec:i,cmd:"wslpath",args:["-w",t],output:n})).stdout.toString().trim())}catch(t){return}},c}return{type:"local",platform:process.platform,exec:p(t),ptyExec:await f(t,e),cwd:t,env:process.env,path:r,homedir:async()=>o.homedir(),tmpdir:async()=>o.tmpdir(),isFile:a.isLocalFile,readFile:a.readLocalFile,writeFile:a.writeLocalFile,rename:a.renameLocal,mkdirp:async t=>{await a.mkdirpLocal(t)},readDir:a.readLocalDir,getuid:async()=>process.getuid(),getgid:async()=>process.getgid(),toCommonURI:async t=>u.URI.file(t)}},e.createLinuxCLIHost=y;const w=/^\\\\wsl\$?\\/;function v(t){return w.test(t.toLowerCase())}function S(t){const e=t.toLowerCase(),n=w.exec(e);if(!n)return"";const r=e.indexOf("\\",n[0].length);return t.substring(n[0].length,r)}function x(t){const e={};return t.trim().split("\n").forEach(t=>{const n=t.indexOf("=");-1!==n&&(e[t.substr(0,n)]=t.substr(n+1))}),e}async function E(t,e,n){const{stdout:r}=await l({exec:p(void 0),cmd:"wsl",args:["-d",t,"-e","wslpath","-u",e],output:n});return r.toString().trim()}e.isWslPath=v,e.getWslDistroNameFromPath=S,e.parsePrintenvOutput=x,e.getWslPath=E,e.toWslPath=async function(t,e){if(v(t)){return E(S(t),t,e)}return t},e.toWslRemoteURI=async function(t,e){const n=S(t),r=await E(n,t,e);return u.URI.parse(`vscode-remote://wsl+${n}${r}`)},e.parseVersion=function(t){const e=/^'?(\d+(\.\d+)*)/.exec(t);if(e)return e[1].split(".").map(t=>parseInt(t,10))},e.isEarlierVersion=function(t,e){for(let n=0,r=Math.max(t.length,e.length);n<r;n++){const r=t[n]||0,o=e[n]||0;if(r!==o)return r<o}return!1}},34:function(t,e){t.exports=require("child_process")},4:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toWarningText=e.toErrorText=e.bailOut=e.ContainerError=void 0;class r extends Error{constructor(t){super(t.originalError&&t.originalError.message||t.description),this.manageContainer=!1,this.actions=[],this.data={},Object.assign(this,t)}}e.ContainerError=r,e.bailOut=function(t,e){throw t.write(`[1m[31m${e}[39m[22m\n`),new Error(e)},e.toErrorText=function(t){return t.split(/\r?\n/).map(t=>`[1m[31m${t}[39m[22m`).join("\r\n")+"\r\n"},e.toWarningText=function(t){return t.split(/\r?\n/).map(t=>`[1m[33m${t}[39m[22m`).join("\r\n")+"\r\n"}},438:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(155),o=n(0),i=n(439),s=n(440),c=n(50),a=n(3),u=n(441),d=process.argv[2],l=process.argv[3];let p=a.LogLevel[process.argv[4]]||a.LogLevel.Info;const f=o.join(process.argv[5],"shutdownMonitor.log");const m=c.createLog((function(t){a.LogLevel.Trace>=p&&r.sendData(d,JSON.stringify({type:"trace",message:t})).catch(t=>{console.error(t)})}),!1,f);m.setLogLevel(p),m.write("Starting monitor process...");const h=Date.now();let g;async function y(t){if(m.write(`Cleaning up after ${Date.now()-h} ms...`),g)switch(g.delay&&(m.write(`Delaying for ${g.delay} ms.`),await u.delay(g.delay)),l){case"dockerCompose":await i.dockerComposeShutdown(g,m);break;case"singleContainer":await s.singleContainerShutdown(g,m);break;case"test":const{stdout:t,stderr:e}=await a.runCommandNoPty({exec:await a.getExecFunction(g.cwd,m),cmd:g.cmd,args:g.args,env:g.env,output:m});m.write("Command output: "+JSON.stringify({stdout:t.toString(),stderr:e.toString()}));break;default:m.write("Type does not exist: "+l)}else m.write("Not configured!");if(m.write("Done."),t)try{const t=await r.sendData(d,JSON.stringify({type:"done"})),e=await r.readJSON(t);m.write("Received reply: "+JSON.stringify(e))}catch(t){m.write("Error confirming to extension: "+(t&&(t.stack||t.message)||String(t)))}}(async()=>{let t=0;for(;;)try{const e=await r.sendData(d,JSON.stringify({type:"poll"})),n=await r.readJSON(e);m.write("Received message: "+JSON.stringify(n));for(const t of n){if("cleanup"===t.type){try{await y(!0)}catch(t){m.write("Unexpected error: "+(t&&(t.stack||t.message)||String(t)))}return}"configure"===t.type&&(g=t.options,g.logLevel&&(p=g.logLevel,m.setLogLevel(p)),r.sendData(d,JSON.stringify({type:"reply",sequence:t.sequence})).catch(t=>{m.write("Error confirming configuration: "+(t&&(t.stack||t.message)||String(t)))}))}t=0}catch(e){if(m.write("Error polling extension: "+(e&&(e.stack||e.message)||String(e))),e&&("ECONNREFUSED"===e.code||"ENOENT"===e.code))return void await y(!1);++t>=5&&await u.delay(1e3)}})().catch(t=>{m.write("Unexpected error: "+(t&&(t.stack||t.message)||String(t)))})},439:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.dockerComposeShutdown=void 0;const r=n(50),o=n(3),i=n(45),s=n(15);e.dockerComposeShutdown=async function(t,e){const n={exec:await o.getExecFunction(t.cwd,e),cmd:t.dockerCLI,env:t.env,output:e};if(t.rebuild){const{stdout:r,stderr:o}=await s.dockerCLI(n,"rm","-f",t.containerId);e.write("Command output: "+JSON.stringify({stdout:r.toString(),stderr:o.toString()}))}else if(!t.shutdownAction||"stopCompose"===t.shutdownAction){const c=s.dockerExecFunction(n,t.containerId,t.user),a=await i.launch(c,e);if(0===(await r.findSessions(a)).filter(e=>e.sessionId!==t.sessionId).length){const r=["--project-name",t.projectName];let i;t.composeFiles.forEach(t=>r.push("-f",t)),r.push("stop","-t","0"),t.runServices&&t.runServices.length&&r.push(...t.runServices);try{let c=n;if(t.buildContainerRunArgs){const{stdout:r}=await s.dockerCLI(n,...t.buildContainerRunArgs);i=r.toString().trim(),c={exec:s.dockerExecFunction(n,i,"root"),cmd:"docker",env:{},output:e}}t.composeOverrideFile&&t.composeOverrideContent&&await o.runCommandNoPty({exec:c.exec,cmd:"/bin/sh",args:["-c",`cat >'${t.composeOverrideFile}'`],stdin:Buffer.from(t.composeOverrideContent),output:e});const{stdout:a,stderr:u}=await s.dockerComposeCLI(c,...r);e.write("Command output: "+JSON.stringify({stdout:a.toString(),stderr:u.toString()}))}finally{i&&await s.dockerCLI(n,"rm","-f",i)}}}}},44:function(t,e){t.exports=require("string_decoder")},440:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.singleContainerShutdown=void 0;const r=n(50),o=n(45),i=n(3),s=n(15);e.singleContainerShutdown=async function(t,e){const n={exec:await i.getExecFunction(t.cwd,e),cmd:t.dockerCLI,env:t.env,output:e};if(t.rebuild){const{stdout:r,stderr:o}=await s.dockerCLI(n,"rm","-f",t.containerId);e.write("Command output: "+JSON.stringify({stdout:r.toString(),stderr:o.toString()}))}else if(!t.shutdownAction||"stopContainer"===t.shutdownAction){const i=s.dockerExecFunction(n,t.containerId,t.user),c=await o.launch(i,e);if(0===(await r.findSessions(c)).filter(e=>e.sessionId!==t.sessionId).length){const{stdout:r,stderr:o}=await s.dockerCLI(n,"stop",t.containerId);e.write("Command output: "+JSON.stringify({stdout:r.toString(),stderr:o.toString()}))}}}},441:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.delay=e.nfcall=void 0,e.nfcall=function(t,...e){return new Promise((n,r)=>t(...e,(t,e)=>t?r(t):n(e)))},e.delay=async function(t){return new Promise(e=>setTimeout(e,t))}},45:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.launch=void 0;const r=n(44);function o(t,e=[1]){const n=e.map(()=>{let t;return{promise:new Promise((e,n)=>t={resolve:e,reject:n}),...t}}),o=new r.StringDecoder("utf8"),i=[];let s=0,c=[];function a(r){!function r(o){const u=o.indexOf("␄");-1!==u?(i.push(o.substr(0,u)),c.push(i.join("")),i.length=0,c.length===e[s]&&(n[s].resolve(c),s++,c=[],s===e.length&&t.off("data",a)),u+1<o.length&&r(o.substr(u+1))):i.push(o)}(o.write(r))}return t.on("data",a),n.map(t=>t.promise)}e.launch=async function(t,e,n,r){const i=await t({env:n?{VSCODE_REMOTE_CONTAINERS_SESSION:n}:{},cmd:r||"/bin/sh",args:[],output:e}),s=function(t){let e;const n=new Promise((t,n)=>e=n),r=[],o=[],i=t=>r.push(t),s=t=>o.push(t);t.stdout.on("data",i),t.stderr.on("data",s),t.exit.then(({code:t,signal:n})=>{e(`Shell server terminated (code: ${t}, signal: ${n})\n${Buffer.concat(r).toString()}\n${Buffer.concat(o).toString()}`)},t=>{e("Shell server failed: "+(t&&(t.stack||t.message)))});return{unexpectedExit:n,disposeStdioListeners:()=>{t.stdout.off("data",i),t.stderr.off("data",s),r.length=0,o.length=0}}}(i);let c;return{exec:async function(t,n){const r=c=(async()=>{try{await c}catch(t){}return async function(t,n){const r="Run in container: "+t.replace(/\n.*/g,""),s=e.start(r);if(i.stdin.destroyed){e.write("Stdin closed!");const{code:t,signal:n}=await i.exit;return Promise.reject({message:`Shell server terminated (code: ${t}, signal: ${n})`,code:t,signal:n})}i.stdin.write(`echo -n ␄; ( ${t} ); echo -n ␄$?␄; echo -n ␄ >&2\n`);const[c,a]=o(i.stdout,[1,2]),u=o(i.stderr)[0];(null==n?void 0:n.stdin)&&(await c,i.stdin.write(null==n?void 0:n.stdin));const[d,l]=await a,[p]=await u,f=parseInt(l,10)||0;!1!==(null==n?void 0:n.logOutput)&&(e.write(d),e.write(p),f&&e.write("Exit code "+f));if(e.stop(r,s),f)return Promise.reject({message:"Command in container failed: "+t,code:f,stdout:d,stderr:p});return{stdout:d,stderr:p}}(t,n)})();try{return await Promise.race([r,s.unexpectedExit])}finally{s.disposeStdioListeners(),c===r&&(c=void 0)}}}}},50:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.findSessions=e.createLog=e.terminalEscapeSequences=void 0;const r=n(8),o=n(1),i=n(0),s=n(3);e.terminalEscapeSequences=/(\x9B|\x1B\[)[0-?]*[ -\/]*[@-~]/g,e.createLog=function(t,n,d){const l=Date.now(),p=[];let f=!1;function m(s,c=!1){!function t(e){if(e&&p.push(e),!f&&p.length){f=!0;const e=p.join("");p.length=0,o.appendFile(d,e,n=>{n&&("ENOENT"===n.code?o.mkdir(i.dirname(d),n=>{n?(f=!1,console.error(n)):o.appendFile(d,e,e=>{f=!1,e&&console.error(e),t()})}):(f=!1,console.error(n))),f=!1,t()})}}(`[${(new Date).toISOString()}] [PID ${process.pid}] ${s.replace(e.terminalEscapeSequences,"").replace(/(\r?\n)?$/,r.EOL)}`),t(c?s:n?s.replace(/\r?\n/g,"\r\n").replace(/(\r?\n)?$/,"\r\n"):s.replace(/(\r?\n)?$/,""))}let h=s.LogLevel.Info;return{write(t,e=s.LogLevel.Critical){e>=h&&m(`[${Date.now()-l} ms] ${t}`)},raw(t,e=s.LogLevel.Critical){e>=h&&m(t,!0)},start(t){const e=Date.now();return s.LogLevel.Debug>=h?m(`${u(a,`[${e-l} ms] Start`)}: ${t}`):s.LogLevel.Critical>=h&&m(`[${e-l} ms] Start: ${t}`),e},stop(t,e){if(s.LogLevel.Debug>=h){const n=Date.now();m(`${u(c,`[${n-l} ms] Stop`)} (${n-e} ms): ${t}`)}},setLogLevel(t){h=t},logFilePath:d}};const c="31",a="32";function u(t,e){return e.split("\n").map(e=>`[1m[${t}m${e}[39m[22m`).join("\n")}e.findSessions=async function(t){return(await s.findProcesses(t)).filter(t=>"VSCODE_REMOTE_CONTAINERS_SESSION"in t.env).map(t=>({...t,sessionId:t.env.VSCODE_REMOTE_CONTAINERS_SESSION}))}},52:function(t,e,n){const{dirname:r}=n(0),o=(t,e,n)=>{e.recursive=!1;const i=r(t);return i===t?e.mkdirAsync(t,e).catch(t=>{if("EISDIR"!==t.code)throw t}):e.mkdirAsync(t,e).then(()=>n||t,r=>{if("ENOENT"===r.code)return o(i,e).then(n=>o(t,e,n));if("EEXIST"!==r.code&&"EROFS"!==r.code)throw r;return e.statAsync(t).then(t=>{if(t.isDirectory())return n;throw r},()=>{throw r})})},i=(t,e,n)=>{const o=r(t);if(e.recursive=!1,o===t)try{return e.mkdirSync(t,e)}catch(t){if("EISDIR"!==t.code)throw t;return}try{return e.mkdirSync(t,e),n||t}catch(r){if("ENOENT"===r.code)return i(t,e,i(o,e,n));if("EEXIST"!==r.code&&"EROFS"!==r.code)throw r;try{if(!e.statSync(t).isDirectory())throw r}catch(t){throw r}}};t.exports={mkdirpManual:o,mkdirpManualSync:i}},6:function(t,e){t.exports=require("util")},77:function(t,e,n){const r=n(84),o=n(85),{mkdirpNative:i,mkdirpNativeSync:s}=n(86),{mkdirpManual:c,mkdirpManualSync:a}=n(52),{useNative:u,useNativeSync:d}=n(88),l=(t,e)=>(t=o(t),e=r(e),u(e)?i(t,e):c(t,e));l.sync=(t,e)=>(t=o(t),e=r(e),d(e)?s(t,e):a(t,e)),l.native=(t,e)=>i(o(t),r(e)),l.manual=(t,e)=>c(o(t),r(e)),l.nativeSync=(t,e)=>s(o(t),r(e)),l.manualSync=(t,e)=>a(o(t),r(e)),t.exports=l},8:function(t,e){t.exports=require("os")},84:function(t,e,n){const{promisify:r}=n(6),o=n(1);t.exports=t=>{if(t)if("object"==typeof t)t={mode:511,fs:o,...t};else if("number"==typeof t)t={mode:t,fs:o};else{if("string"!=typeof t)throw new TypeError("invalid options argument");t={mode:parseInt(t,8),fs:o}}else t={mode:511,fs:o};return t.mkdir=t.mkdir||t.fs.mkdir||o.mkdir,t.mkdirAsync=r(t.mkdir),t.stat=t.stat||t.fs.stat||o.stat,t.statAsync=r(t.stat),t.statSync=t.statSync||t.fs.statSync||o.statSync,t.mkdirSync=t.mkdirSync||t.fs.mkdirSync||o.mkdirSync,t}},85:function(t,e,n){const r=process.env.__TESTING_MKDIRP_PLATFORM__||process.platform,{resolve:o,parse:i}=n(0);t.exports=t=>{if(/\0/.test(t))throw Object.assign(new TypeError("path must be a string without null bytes"),{path:t,code:"ERR_INVALID_ARG_VALUE"});if(t=o(t),"win32"===r){const e=/[*|"<>?:]/,{root:n}=i(t);if(e.test(t.substr(n.length)))throw Object.assign(new Error("Illegal characters in path."),{path:t,code:"EINVAL"})}return t}},86:function(t,e,n){const{dirname:r}=n(0),{findMade:o,findMadeSync:i}=n(87),{mkdirpManual:s,mkdirpManualSync:c}=n(52);t.exports={mkdirpNative:(t,e)=>{e.recursive=!0;return r(t)===t?e.mkdirAsync(t,e):o(e,t).then(n=>e.mkdirAsync(t,e).then(()=>n).catch(n=>{if("ENOENT"===n.code)return s(t,e);throw n}))},mkdirpNativeSync:(t,e)=>{e.recursive=!0;if(r(t)===t)return e.mkdirSync(t,e);const n=i(e,t);try{return e.mkdirSync(t,e),n}catch(n){if("ENOENT"===n.code)return c(t,e);throw n}}}},87:function(t,e,n){const{dirname:r}=n(0),o=(t,e,n)=>n===e?Promise.resolve():t.statAsync(e).then(t=>t.isDirectory()?n:void 0,n=>"ENOENT"===n.code?o(t,r(e),e):void 0),i=(t,e,n)=>{if(n!==e)try{return t.statSync(e).isDirectory()?n:void 0}catch(n){return"ENOENT"===n.code?i(t,r(e),e):void 0}};t.exports={findMade:o,findMadeSync:i}},88:function(t,e,n){const r=n(1),o=(process.env.__TESTING_MKDIRP_NODE_VERSION__||process.version).replace(/^v/,"").split("."),i=+o[0]>10||10==+o[0]&&+o[1]>=12,s=i?t=>t.mkdir===r.mkdir:()=>!1,c=i?t=>t.mkdirSync===r.mkdirSync:()=>!1;t.exports={useNative:s,useNativeSync:c}},9:function(t,e){t.exports=require("http")}}));
//# sourceMappingURL=shutdownMonitorProcess.js.map